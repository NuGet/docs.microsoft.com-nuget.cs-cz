---
title: Řešení závislostí balíčku NuGet
description: Podrobnosti o procesu, pomocí kterého se v NuGet 2. x a NuGet 3. x + vyřeší a nainstalují závislosti balíčku NuGet.
author: karann-msft
ms.author: karann
ms.date: 08/14/2017
ms.topic: conceptual
ms.openlocfilehash: c6f50e6eb21826afebcdcd4045c7ab8b6e6489e3
ms.sourcegitcommit: e9c1dd0679ddd8ba3ee992d817b405f13da0472a
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/29/2020
ms.locfileid: "76813322"
---
# <a name="how-nuget-resolves-package-dependencies"></a><span data-ttu-id="7daa4-103">Jak NuGet řeší závislosti balíčků</span><span class="sxs-lookup"><span data-stu-id="7daa4-103">How NuGet resolves package dependencies</span></span>

<span data-ttu-id="7daa4-104">Při každém instalaci nebo přeinstalaci balíčku, který zahrnuje instalaci jako součást procesu [obnovení](../consume-packages/package-restore.md) , nainstaluje také všechny další balíčky, na kterých je první balíček závislý.</span><span class="sxs-lookup"><span data-stu-id="7daa4-104">Any time a package is installed or reinstalled, which includes being installed as part of a [restore](../consume-packages/package-restore.md) process, NuGet also installs any additional packages on which that first package depends.</span></span>

<span data-ttu-id="7daa4-105">Tyto okamžité závislosti mohou mít také vlastní závislosti, které mohou pokračovat s libovolnou hloubkou.</span><span class="sxs-lookup"><span data-stu-id="7daa4-105">Those immediate dependencies might then also have dependencies on their own, which can continue to an arbitrary depth.</span></span> <span data-ttu-id="7daa4-106">Tím se říká *graf závislosti* , který popisuje vztahy mezi balíčky na všech úrovních.</span><span class="sxs-lookup"><span data-stu-id="7daa4-106">This produces what's called a *dependency graph* that describes the relationships between packages at all levels.</span></span>

<span data-ttu-id="7daa4-107">Pokud má více balíčků stejnou závislost, pak se stejné ID balíčku může v grafu zobrazit víckrát, potenciálně s různými omezeními verze.</span><span class="sxs-lookup"><span data-stu-id="7daa4-107">When multiple packages have the same dependency, then the same package ID can appear in the graph multiple times, potentially with different version constraints.</span></span> <span data-ttu-id="7daa4-108">V projektu se však dá použít jenom jedna verze daného balíčku, takže NuGet musí zvolit, která verze se má použít.</span><span class="sxs-lookup"><span data-stu-id="7daa4-108">However, only one version of a given package can be used in a project, so NuGet must choose which version is used.</span></span> <span data-ttu-id="7daa4-109">Přesný proces závisí na použitém formátu správy balíčků.</span><span class="sxs-lookup"><span data-stu-id="7daa4-109">The exact process depends on the package management format being used.</span></span>

## <a name="dependency-resolution-with-packagereference"></a><span data-ttu-id="7daa4-110">Rozlišení závislosti s PackageReference</span><span class="sxs-lookup"><span data-stu-id="7daa4-110">Dependency resolution with PackageReference</span></span>

<span data-ttu-id="7daa4-111">Při instalaci balíčků do projektů pomocí formátu PackageReference přidá NuGet v příslušném souboru odkazy na graf plochých balíčků a vyřeší konflikty před časem.</span><span class="sxs-lookup"><span data-stu-id="7daa4-111">When installing packages into projects using the PackageReference format, NuGet adds references to a flat package graph in the appropriate file and resolves conflicts ahead of time.</span></span> <span data-ttu-id="7daa4-112">Tento proces se označuje jako *přechodné obnovení*.</span><span class="sxs-lookup"><span data-stu-id="7daa4-112">This process is referred to as *transitive restore*.</span></span> <span data-ttu-id="7daa4-113">Přeinstalace nebo obnovení balíčků je proces stahování balíčků uvedených v grafu, což vede k rychlejšímu a více předvídatelným sestavením.</span><span class="sxs-lookup"><span data-stu-id="7daa4-113">Reinstalling or restoring packages is then a process of downloading the packages listed in the graph, resulting in faster and more predictable builds.</span></span> <span data-ttu-id="7daa4-114">Můžete také využít výhod zástupných znaků (plovoucí), například 2,8.\*, což umožňuje vyhnout se nákladným a náchylným chybám a voláním `nuget update` na klientských počítačích a serverech sestavení.</span><span class="sxs-lookup"><span data-stu-id="7daa4-114">You can also take advantage of wildcard (floating) versions, such as 2.8.\*, avoiding expensive and error prone calls to `nuget update` on the client machines and build servers.</span></span>

<span data-ttu-id="7daa4-115">Když se proces obnovení NuGet spustí před sestavením, vyřeší nejprve závislosti v paměti a pak zapíše výsledný graf do souboru s názvem `project.assets.json`.</span><span class="sxs-lookup"><span data-stu-id="7daa4-115">When the NuGet restore process runs prior to a build, it resolves dependencies first in memory, then writes the resulting graph to a file called `project.assets.json`.</span></span> <span data-ttu-id="7daa4-116">Zapisuje také vyřešené závislosti do souboru zámku s názvem `packages.lock.json`, pokud [je povolena funkce zámku souboru](../consume-packages/package-references-in-project-files.md#locking-dependencies).</span><span class="sxs-lookup"><span data-stu-id="7daa4-116">It also writes the resolved dependencies to a lock file named `packages.lock.json`, if the [lock file functionality is enabled](../consume-packages/package-references-in-project-files.md#locking-dependencies).</span></span>
<span data-ttu-id="7daa4-117">Soubor prostředků je umístěn na `MSBuildProjectExtensionsPath`, který je ve výchozím nastavení složkou "obj" projektu.</span><span class="sxs-lookup"><span data-stu-id="7daa4-117">The assets file is located at `MSBuildProjectExtensionsPath`, which defaults to the project's 'obj' folder.</span></span> <span data-ttu-id="7daa4-118">Nástroj MSBuild pak přečte tento soubor a převede ho do sady složek, kde mohou být nalezeny možné odkazy, a poté je přidá do stromu projektu v paměti.</span><span class="sxs-lookup"><span data-stu-id="7daa4-118">MSBuild then reads this file and translates it into a set of folders where potential references can be found, and then adds them to the project tree in memory.</span></span>

<span data-ttu-id="7daa4-119">Soubor `project.assets.json` je dočasný a neměl by být přidán do správy zdrojových kódů.</span><span class="sxs-lookup"><span data-stu-id="7daa4-119">The `project.assets.json` file is temporary and should not be added to source control.</span></span> <span data-ttu-id="7daa4-120">Je uvedený ve výchozím nastavení v `.gitignore` i `.tfignore`.</span><span class="sxs-lookup"><span data-stu-id="7daa4-120">It's listed by default in both `.gitignore` and `.tfignore`.</span></span> <span data-ttu-id="7daa4-121">Viz [balíčky a Správa zdrojového kódu](../consume-packages/packages-and-source-control.md).</span><span class="sxs-lookup"><span data-stu-id="7daa4-121">See [Packages and source control](../consume-packages/packages-and-source-control.md).</span></span>

### <a name="dependency-resolution-rules"></a><span data-ttu-id="7daa4-122">Pravidla řešení závislostí</span><span class="sxs-lookup"><span data-stu-id="7daa4-122">Dependency resolution rules</span></span>

<span data-ttu-id="7daa4-123">Přenosné obnovení používá čtyři hlavní pravidla pro řešení závislostí: nejnižší použitelná verze, plovoucí verze, nejbližší služba WINS a závislosti Cousin.</span><span class="sxs-lookup"><span data-stu-id="7daa4-123">Transitive restore applies four main rules to resolve dependencies: lowest applicable version, floating versions, nearest-wins, and cousin dependencies.</span></span>

<a name="lowest-applicable-version"></a>

#### <a name="lowest-applicable-version"></a><span data-ttu-id="7daa4-124">Nejnižší platná verze</span><span class="sxs-lookup"><span data-stu-id="7daa4-124">Lowest applicable version</span></span>

<span data-ttu-id="7daa4-125">Nejnižší platná verze pravidla obnoví nejnižší možnou verzi balíčku, jak je definuje jeho závislosti.</span><span class="sxs-lookup"><span data-stu-id="7daa4-125">The lowest applicable version rule restores the lowest possible version of a package as defined by its dependencies.</span></span> <span data-ttu-id="7daa4-126">Platí také pro závislosti na aplikaci nebo knihovně tříd, pokud není deklarována jako [plovoucí](#floating-versions).</span><span class="sxs-lookup"><span data-stu-id="7daa4-126">It also applies to dependencies on the application or the class library unless declared as [floating](#floating-versions).</span></span>

<span data-ttu-id="7daa4-127">Na následujícím obrázku je například 1,0-beta považován za nižší než 1,0, takže NuGet zvolí verzi 1,0:</span><span class="sxs-lookup"><span data-stu-id="7daa4-127">In the following figure, for example, 1.0-beta is considered lower than 1.0 so NuGet chooses the 1.0 version:</span></span>

![Výběr nejnižší použitelné verze](media/projectJson-dependency-1.png)

<span data-ttu-id="7daa4-129">Na následujícím obrázku verze 2,1 není v informačním kanálu k dispozici, ale vzhledem k tomu, že omezení verze je > = 2,1 NuGet vybere další nejnižší verzi, kterou může najít, v tomto případě 2,2:</span><span class="sxs-lookup"><span data-stu-id="7daa4-129">In the next figure, version 2.1 is not available on the feed but because the version constraint is >= 2.1 NuGet picks the next lowest version it can find, in this case 2.2:</span></span>

![Výběr nejbližší nejnižší verze dostupné v informačním kanálu](media/projectJson-dependency-2.png)

<span data-ttu-id="7daa4-131">Když aplikace určí přesné číslo verze, například 1,2, které není v informačním kanálu k dispozici, NuGet při pokusu o instalaci nebo obnovení balíčku dojde k chybě.</span><span class="sxs-lookup"><span data-stu-id="7daa4-131">When an application specifies an exact version number, such as 1.2, that is not available on the feed, NuGet fails with an error when attempting to install or restore the package:</span></span>

![NuGet vygeneruje chybu, pokud není dostupná přesná verze balíčku.](media/projectJson-dependency-3.png)

<a name="floating-versions"></a>

#### <a name="floating-wildcard-versions"></a><span data-ttu-id="7daa4-133">Plovoucí verze (zástupné znaky)</span><span class="sxs-lookup"><span data-stu-id="7daa4-133">Floating (wildcard) versions</span></span>

<span data-ttu-id="7daa4-134">V případě, že je zadána verze s plovoucí nebo zástupné znaky, je \* zástupný znak, jako je 6,0.\*.</span><span class="sxs-lookup"><span data-stu-id="7daa4-134">A floating or wildcard dependency version is specified with the \* wildcard, as with 6.0.\*.</span></span> <span data-ttu-id="7daa4-135">Tato specifikace verze říká "použít nejnovější verzi 6.0. x"; 4.\* znamená "použít nejnovější verzi 4. x."</span><span class="sxs-lookup"><span data-stu-id="7daa4-135">This version specification says "use the latest 6.0.x version"; 4.\* means "use the latest 4.x version."</span></span> <span data-ttu-id="7daa4-136">Použití zástupného znaku umožňuje, aby balíček závislostí pokračoval ve vývoji bez nutnosti změny náročné aplikace (nebo balíčku).</span><span class="sxs-lookup"><span data-stu-id="7daa4-136">Using a wildcard allows a dependency package to continue evolving without requiring a change to the consuming application (or package).</span></span>

<span data-ttu-id="7daa4-137">Při použití zástupného znaku NuGet vyřeší nejvyšší verzi balíčku, který odpovídá vzoru verze, například 6,0.\* získá nejvyšší verzi balíčku, který začíná 6,0:</span><span class="sxs-lookup"><span data-stu-id="7daa4-137">When using a wildcard, NuGet resolves the highest version of a package that matches the version pattern, for example 6.0.\* gets the highest version of a package that starts with 6.0:</span></span>

![Výběr verze 6.0.1, když se požaduje plovoucí verze 6,0. \*](media/projectJson-dependency-4.png)

> [!Note]
> <span data-ttu-id="7daa4-139">Informace o chování zástupných znaků a předběžných verzích najdete v tématu [Správa verzí balíčků](package-versioning.md#version-ranges-and-wildcards).</span><span class="sxs-lookup"><span data-stu-id="7daa4-139">For information on the behavior of wildcards and pre-release versions, see [Package versioning](package-versioning.md#version-ranges-and-wildcards).</span></span>


<a name="nearest-wins"></a>

#### <a name="nearest-wins"></a><span data-ttu-id="7daa4-140">Nejbližší služba WINS</span><span class="sxs-lookup"><span data-stu-id="7daa4-140">Nearest wins</span></span>

<span data-ttu-id="7daa4-141">Když graf balíčku pro aplikaci obsahuje různé verze stejného balíčku, vybere NuGet balíček, který je nejblíže aplikaci v grafu a ignoruje všechny ostatní.</span><span class="sxs-lookup"><span data-stu-id="7daa4-141">When the package graph for an application contains different versions of the same package, NuGet chooses the package that's closest to the application in the graph and ignores all others.</span></span> <span data-ttu-id="7daa4-142">Toto chování umožňuje aplikaci přepsat jakoukoli konkrétní verzi balíčku v grafu závislostí.</span><span class="sxs-lookup"><span data-stu-id="7daa4-142">This behavior allows an application to override any particular package version in the dependency graph.</span></span>

<span data-ttu-id="7daa4-143">V následujícím příkladu aplikace závisí přímo na balíčku B s omezením verze > = 2.0.</span><span class="sxs-lookup"><span data-stu-id="7daa4-143">In the example below, the application depends directly on Package B with a version constraint of >=2.0.</span></span> <span data-ttu-id="7daa4-144">Aplikace také závisí na balíčku A, který také závisí na balíčku B, ale s omezením > = 1.0.</span><span class="sxs-lookup"><span data-stu-id="7daa4-144">The application also depends on Package A which in turn also depends on Package B, but with a >=1.0 constraint.</span></span> <span data-ttu-id="7daa4-145">Vzhledem k tomu, že závislost na balíčku B 2,0 je blízko aplikace v grafu, používá se tato verze:</span><span class="sxs-lookup"><span data-stu-id="7daa4-145">Because the dependency on Package B 2.0 is nearer to the application in the graph, that version is used:</span></span>

![Aplikace používající nejbližší pravidlo služby WINS](media/projectJson-dependency-5.png)

>[!Warning]
> <span data-ttu-id="7daa4-147">Nejbližší pravidlo služby WINS může mít za následek downgrade verze balíčku, takže může poškodit jiné závislosti v grafu.</span><span class="sxs-lookup"><span data-stu-id="7daa4-147">The Nearest Wins rule can result in a downgrade of the package version, thus potentially breaking other dependencies in the graph.</span></span> <span data-ttu-id="7daa4-148">Proto se toto pravidlo použije s upozorněním na upozornění uživatele.</span><span class="sxs-lookup"><span data-stu-id="7daa4-148">Hence this rule is applied with a warning to alert the user.</span></span>

<span data-ttu-id="7daa4-149">Toto pravidlo také vede k větší efektivitě s rozsáhlým grafem závislosti (jako jsou s balíčky BCL), protože jakmile se daná závislost ignoruje, NuGet také ignoruje všechny zbývající závislosti v této větvi grafu.</span><span class="sxs-lookup"><span data-stu-id="7daa4-149">This rule also results in greater efficiency with a large dependency graph (such as those with the BCL packages) because once a given dependency is ignored, NuGet also ignores all remaining dependencies on that branch of the graph.</span></span> <span data-ttu-id="7daa4-150">V následujícím diagramu, například, protože se používá balíček C 2,0, ignoruje NuGet všechny větve v grafu, které odkazují na starší verzi balíčku C:</span><span class="sxs-lookup"><span data-stu-id="7daa4-150">In the diagram below, for example, because Package C 2.0 is used, NuGet ignores any branches in the graph that refer to an older version of Package C:</span></span>

![Když NuGet ignoruje balíček v grafu, ignoruje celou větev.](media/projectJson-dependency-6.png)

<a name="cousin-dependencies"></a>

#### <a name="cousin-dependencies"></a><span data-ttu-id="7daa4-152">Závislosti Cousin</span><span class="sxs-lookup"><span data-stu-id="7daa4-152">Cousin dependencies</span></span>

<span data-ttu-id="7daa4-153">V případě, že se na stejnou vzdálenost v grafu od aplikace odkazují různé verze balíčků, používá NuGet nejnižší verzi, která splňuje všechny požadavky na verzi (stejně jako u [nejnižší použitelné verze](#lowest-applicable-version) a pravidla pro [plovoucí verze](#floating-versions) ).</span><span class="sxs-lookup"><span data-stu-id="7daa4-153">When different package versions are referred to at the same distance in the graph from the application, NuGet uses the lowest version that satisfies all version requirements (as with the [lowest applicable version](#lowest-applicable-version) and [floating versions](#floating-versions) rules).</span></span> <span data-ttu-id="7daa4-154">Na následujícím obrázku je například verze 2,0 balíčku B, která splňuje jiné omezení > = 1.0 a používá se takto:</span><span class="sxs-lookup"><span data-stu-id="7daa4-154">In the image below, for example, version 2.0 of Package B satisfies the other >=1.0 constraint, and is thus used:</span></span>

![Řešení závislostí Cousin pomocí nižší verze, která splňuje všechna omezení](media/projectJson-dependency-7.png)

<span data-ttu-id="7daa4-156">V některých případech není možné splnit všechny požadavky na verzi.</span><span class="sxs-lookup"><span data-stu-id="7daa4-156">In some cases, it's not possible to meet all version requirements.</span></span> <span data-ttu-id="7daa4-157">Jak je vidět níže, pokud balíček A vyžaduje přesně balíček B 1,0 a balíček C vyžaduje balíček B > = 2.0, nemůže NuGet vyřešit závislosti a zobrazí chybu.</span><span class="sxs-lookup"><span data-stu-id="7daa4-157">As shown below, if Package A requires exactly Package B 1.0 and Package C requires Package B >=2.0, then NuGet cannot resolve the dependencies and gives an error.</span></span>

![Nepřeložitelné závislosti z důvodu přesného požadavku na verzi](media/projectJson-dependency-8.png)

<span data-ttu-id="7daa4-159">V těchto situacích by měl uživatel nejvyšší úrovně (aplikace nebo balíček) přidat vlastní přímou závislost na balíčku B, aby se [nejbližší pravidlo služby WINS](#nearest-wins) naplatilo.</span><span class="sxs-lookup"><span data-stu-id="7daa4-159">In these situations, the top-level consumer (the application or package) should add its own direct dependency on Package B so that the [Nearest Wins](#nearest-wins) rule applies.</span></span>

## <a name="dependency-resolution-with-packagesconfig"></a><span data-ttu-id="7daa4-160">Řešení závislosti s balíčky. config</span><span class="sxs-lookup"><span data-stu-id="7daa4-160">Dependency resolution with packages.config</span></span>

<span data-ttu-id="7daa4-161">Při `packages.config`jsou závislosti projektu zapisovány do `packages.config` jako nestrukturovaný seznam.</span><span class="sxs-lookup"><span data-stu-id="7daa4-161">With `packages.config`, a project's dependencies are written to `packages.config` as a flat list.</span></span> <span data-ttu-id="7daa4-162">Všechny závislosti těchto balíčků jsou také zapsány ve stejném seznamu.</span><span class="sxs-lookup"><span data-stu-id="7daa4-162">Any dependencies of those packages are also written in the same list.</span></span> <span data-ttu-id="7daa4-163">Po instalaci balíčků může NuGet změnit také soubor `.csproj`, `app.config`, `web.config`a další jednotlivé soubory.</span><span class="sxs-lookup"><span data-stu-id="7daa4-163">When packages are installed, NuGet might also modify the `.csproj` file, `app.config`, `web.config`, and other individual files.</span></span>

<span data-ttu-id="7daa4-164">Při `packages.config`se NuGet pokusí vyřešit konflikty závislostí při instalaci každého jednotlivého balíčku.</span><span class="sxs-lookup"><span data-stu-id="7daa4-164">With `packages.config`, NuGet attempts to resolve dependency conflicts during the installation of each individual package.</span></span> <span data-ttu-id="7daa4-165">To znamená, že pokud je balíček A nainstalován a závisí na balíčku B, a balíček B je již uveden v `packages.config` jako závislost nějakého jiného, NuGet porovná požadované verze balíčku B a pokusí se najít verzi, která splňuje všechna omezení verzí.</span><span class="sxs-lookup"><span data-stu-id="7daa4-165">That is, if Package A is being installed and depends on Package B, and Package B is already listed in `packages.config` as a dependency of something else, NuGet compares the versions of Package B being requested and attempts to find a version that satisfies all version constraints.</span></span> <span data-ttu-id="7daa4-166">Konkrétně vybere nižší *hlavní verzi.* podverze, která splňuje závislosti.</span><span class="sxs-lookup"><span data-stu-id="7daa4-166">Specifically, NuGet selects the lower *major.minor* version that satisfies dependencies.</span></span>

<span data-ttu-id="7daa4-167">Ve výchozím nastavení vyhledá NuGet 2,8 nejnižší verzi opravy (viz zpráva k [vydání verze NuGet 2,8](../release-notes/nuget-2.8.md#patch-resolution-for-dependencies)).</span><span class="sxs-lookup"><span data-stu-id="7daa4-167">By default, NuGet 2.8 looks for the lowest patch version (see [NuGet 2.8 release notes](../release-notes/nuget-2.8.md#patch-resolution-for-dependencies)).</span></span> <span data-ttu-id="7daa4-168">Toto nastavení můžete řídit pomocí atributu `DependencyVersion` v `Nuget.Config` a přepínače `-DependencyVersion` na příkazovém řádku.</span><span class="sxs-lookup"><span data-stu-id="7daa4-168">You can control this setting through the `DependencyVersion` attribute in `Nuget.Config` and the `-DependencyVersion` switch on the command line.</span></span>  

<span data-ttu-id="7daa4-169">Proces `packages.config` pro řešení závislostí bude pro větší grafy závislostí složitý.</span><span class="sxs-lookup"><span data-stu-id="7daa4-169">The `packages.config` process for resolving dependencies gets complicated for larger dependency graphs.</span></span> <span data-ttu-id="7daa4-170">Každé nové instalaci balíčku vyžaduje procházení celého grafu a vyvolává pravděpodobnost konfliktu verzí.</span><span class="sxs-lookup"><span data-stu-id="7daa4-170">Each new package installation requires a traversal of the whole graph and raises the chance for version conflicts.</span></span> <span data-ttu-id="7daa4-171">Dojde-li ke konfliktu, instalace je zastavena a projekt zůstane v neurčitém stavu, zejména s případnými změnami samotného souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="7daa4-171">When a conflict occurs, installation is stopped, leaving the project in an indeterminate state, especially with potential modifications to the project file itself.</span></span> <span data-ttu-id="7daa4-172">Nejedná se o problém při použití jiných formátů správy balíčků.</span><span class="sxs-lookup"><span data-stu-id="7daa4-172">This is not an issue when using other package management formats.</span></span>

## <a name="managing-dependency-assets"></a><span data-ttu-id="7daa4-173">Správa prostředků závislosti</span><span class="sxs-lookup"><span data-stu-id="7daa4-173">Managing dependency assets</span></span>

<span data-ttu-id="7daa4-174">Při použití formátu PackageReference můžete řídit, které prostředky se mají směrovat do projektu nejvyšší úrovně.</span><span class="sxs-lookup"><span data-stu-id="7daa4-174">When using the PackageReference format, you can control which assets from dependencies flow into the top-level project.</span></span> <span data-ttu-id="7daa4-175">Podrobnosti najdete v tématu [PackageReference](../consume-packages/package-references-in-project-files.md#controlling-dependency-assets).</span><span class="sxs-lookup"><span data-stu-id="7daa4-175">For details, see [PackageReference](../consume-packages/package-references-in-project-files.md#controlling-dependency-assets).</span></span>

<span data-ttu-id="7daa4-176">Když je projekt nejvyšší úrovně sám balíčkem, máte také kontrolu nad tímto tokem pomocí atributů `include` a `exclude` se závislostmi uvedenými v souboru `.nuspec`.</span><span class="sxs-lookup"><span data-stu-id="7daa4-176">When the top-level project is itself a package, you also have control over this flow by using the `include` and `exclude` attributes with dependencies listed in the `.nuspec` file.</span></span> <span data-ttu-id="7daa4-177">Viz [referenční závislosti. nuspec](../reference/nuspec.md#dependencies).</span><span class="sxs-lookup"><span data-stu-id="7daa4-177">See [.nuspec Reference - Dependencies](../reference/nuspec.md#dependencies).</span></span>

## <a name="excluding-references"></a><span data-ttu-id="7daa4-178">Vyloučení odkazů</span><span class="sxs-lookup"><span data-stu-id="7daa4-178">Excluding references</span></span>

<span data-ttu-id="7daa4-179">Existují scénáře, ve kterých může být sestavení se stejným názvem v projektu odkazována více než jednou, což vyprodukuje chyby návrhu a doby sestavování.</span><span class="sxs-lookup"><span data-stu-id="7daa4-179">There are scenarios in which assemblies with the same name might be referenced more than once in a project, producing design-time and build-time errors.</span></span> <span data-ttu-id="7daa4-180">Vezměte v úvahu projekt, který obsahuje vlastní verzi `C.dll`a odkazuje na balíček C, který obsahuje také `C.dll`.</span><span class="sxs-lookup"><span data-stu-id="7daa4-180">Consider a project that contains a custom version of `C.dll`, and references Package C that also contains `C.dll`.</span></span> <span data-ttu-id="7daa4-181">Zároveň projekt závisí také na balíčku B, který také závisí na balíčku C a `C.dll`.</span><span class="sxs-lookup"><span data-stu-id="7daa4-181">At the same time, the project also depends on Package B which also depends on Package C and `C.dll`.</span></span> <span data-ttu-id="7daa4-182">V důsledku toho NuGet nemůže určit, který `C.dll` použít, ale nemůžete pouze odebrat závislost projektu na balíčku C, protože na něm také závisí balíček B.</span><span class="sxs-lookup"><span data-stu-id="7daa4-182">As a result, NuGet can't determine which `C.dll` to use, but you can't just remove the project's dependency on Package C because Package B also depends on it.</span></span>

<span data-ttu-id="7daa4-183">Chcete-li tento problém vyřešit, musíte přímo odkazovat na `C.dll`, které chcete (nebo použít jiný balíček, který odkazuje na příslušný soubor), a pak přidat závislost na balíčku C, který vylučuje všechny jeho prostředky.</span><span class="sxs-lookup"><span data-stu-id="7daa4-183">To resolve this, you must directly reference the `C.dll` you want (or use another package that references the right one), and then add a dependency on Package C that excludes all its assets.</span></span> <span data-ttu-id="7daa4-184">To se provádí takto v závislosti na použitém formátu správy balíčků:</span><span class="sxs-lookup"><span data-stu-id="7daa4-184">This is done as follows depending on the package management format in use:</span></span>

- <span data-ttu-id="7daa4-185">[PackageReference](../consume-packages/package-references-in-project-files.md): přidejte `ExcludeAssets="All"` v závislosti:</span><span class="sxs-lookup"><span data-stu-id="7daa4-185">[PackageReference](../consume-packages/package-references-in-project-files.md): add `ExcludeAssets="All"` in the dependency:</span></span>

    ```xml
    <PackageReference Include="PackageC" Version="1.0.0" ExcludeAssets="All" />
    ```

- <span data-ttu-id="7daa4-186">`packages.config`: Odeberte odkaz na PackageC ze souboru `.csproj`, aby odkazoval jenom na požadovanou verzi `C.dll`.</span><span class="sxs-lookup"><span data-stu-id="7daa4-186">`packages.config`: remove the reference to PackageC from the `.csproj` file so that it references only the version of `C.dll` that you want.</span></span>
    
## <a name="dependency-updates-during-package-install"></a><span data-ttu-id="7daa4-187">Aktualizace závislostí při instalaci balíčku</span><span class="sxs-lookup"><span data-stu-id="7daa4-187">Dependency updates during package install</span></span> 

<span data-ttu-id="7daa4-188">Pokud je už verze závislosti splněná, závislost se během dalších instalací balíčku neaktualizuje.</span><span class="sxs-lookup"><span data-stu-id="7daa4-188">If a dependency version is already satisfied, the dependency isn't updated during other package installations.</span></span> <span data-ttu-id="7daa4-189">Zvažte například balíček A, který je závislý na balíčku B, a pro číslo verze určí 1,0.</span><span class="sxs-lookup"><span data-stu-id="7daa4-189">For example, consider package A that depends on package B and specifies 1.0 for the version number.</span></span> <span data-ttu-id="7daa4-190">Zdrojové úložiště obsahuje verze 1,0, 1,1 a 1,2 balíčku B. Pokud je nainstalován v projektu, který již obsahuje B verze 1,0, pak B 1,0 zůstává používán, protože splňuje omezení verze.</span><span class="sxs-lookup"><span data-stu-id="7daa4-190">The source repository contains versions 1.0, 1.1, and 1.2 of package B. If A is installed in a project that already contains B version 1.0, then B 1.0 remains in use because it satisfies the version constraint.</span></span> <span data-ttu-id="7daa4-191">Pokud se ale v balíčku A dostaly požadavky verze 1,1 nebo vyšší z B, pak se nainstaluje B 1,2.</span><span class="sxs-lookup"><span data-stu-id="7daa4-191">However, if package A had requests version 1.1 or higher of B, then B 1.2 would be installed.</span></span> 

## <a name="resolving-incompatible-package-errors"></a><span data-ttu-id="7daa4-192">Řešení chyb nekompatibilních balíčků</span><span class="sxs-lookup"><span data-stu-id="7daa4-192">Resolving incompatible package errors</span></span>

<span data-ttu-id="7daa4-193">Během operace obnovení balíčku se může zobrazit chyba, že jeden nebo více balíčků není kompatibilních... nebo že balíček "není kompatibilní" s cílovým rozhraním projektu.</span><span class="sxs-lookup"><span data-stu-id="7daa4-193">During a package restore operation, you may see the error "One or more packages are not compatible..." or that a package "is not compatible" with the project's target framework.</span></span>

<span data-ttu-id="7daa4-194">K této chybě dochází, pokud jeden nebo více balíčků, na které se odkazuje v projektu, neindikuje, že podporují cílové rozhraní projektu. To znamená, že balíček neobsahuje vhodnou knihovnu DLL ve složce `lib` pro cílovou architekturu, která je kompatibilní s projektem.</span><span class="sxs-lookup"><span data-stu-id="7daa4-194">This error occurs when one or more of the packages referenced in your project do not indicate that they support the project's target framework; that is, the package does not contain a suitable DLL in its `lib` folder for a target framework that is compatible with the project.</span></span> <span data-ttu-id="7daa4-195">(Viz [cílové architektury](../reference/target-frameworks.md) pro seznam.)</span><span class="sxs-lookup"><span data-stu-id="7daa4-195">(See [Target frameworks](../reference/target-frameworks.md) for a list.)</span></span> 

<span data-ttu-id="7daa4-196">Například pokud projekt cílí na `netstandard1.6` a pokusíte se nainstalovat balíček, který obsahuje knihovny DLL pouze v `lib\net20` a `\lib\net45` složky, pak se zobrazí zprávy podobné následujícímu balíčku pro balíček a případně jeho závislé položky:</span><span class="sxs-lookup"><span data-stu-id="7daa4-196">For example, if a project targets `netstandard1.6` and you attempt to install a package that contains DLLs in only the `lib\net20` and `\lib\net45` folders, then you see messages like the following for the package and possibly its dependents:</span></span>

```output
Restoring packages for myproject.csproj...
Package ContosoUtilities 2.1.2.3 is not compatible with netstandard1.6 (.NETStandard,Version=v1.6). Package ContosoUtilities 2.1.2.3 supports:
  - net20 (.NETFramework,Version=v2.0)
  - net45 (.NETFramework,Version=v4.5)
Package ContosoCore 0.86.0 is not compatible with netstandard1.6 (.NETStandard,Version=v1.6). Package ContosoCore 0.86.0 supports:
  - 11 (11,Version=v0.0)
  - net20 (.NETFramework,Version=v2.0)
  - sl3 (Silverlight,Version=v3.0)
  - sl4 (Silverlight,Version=v4.0)
One or more packages are incompatible with .NETStandard,Version=v1.6.
Package restore failed. Rolling back package changes for 'MyProject'.
```

<span data-ttu-id="7daa4-197">Chcete-li vyřešit nekompatibilitu, proveďte jednu z následujících akcí:</span><span class="sxs-lookup"><span data-stu-id="7daa4-197">To resolve incompatibilities, do one of the following:</span></span>

- <span data-ttu-id="7daa4-198">Svůj projekt můžete změnit na rámec, který podporují balíčky, které chcete použít.</span><span class="sxs-lookup"><span data-stu-id="7daa4-198">Retarget your project to a framework that is supported by the packages you want to use.</span></span>
- <span data-ttu-id="7daa4-199">Kontaktujte autora balíčků a pracujte s nimi a přidejte podporu pro zvolenou architekturu.</span><span class="sxs-lookup"><span data-stu-id="7daa4-199">Contact the author of the packages and work with them to add support for your chosen framework.</span></span> <span data-ttu-id="7daa4-200">Každá stránka se seznamem balíčků na [NuGet.org](https://www.nuget.org/) má pro tento účel odkaz pro **vlastníky kontaktů** .</span><span class="sxs-lookup"><span data-stu-id="7daa4-200">Each package listing page on [nuget.org](https://www.nuget.org/) has a **Contact Owners** link for this purpose.</span></span>
