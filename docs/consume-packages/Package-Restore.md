---
title: Obnovení balíčků NuGet
description: Přehled, jak balíčky NuGet obnovení projektu závisí na, včetně postup zakázání obnovení a omezení verze.
author: karann-msft
ms.author: karann
ms.date: 06/24/2019
ms.topic: conceptual
ms.openlocfilehash: e85d8cc3fd9492118bd8f34cfd05f20a9724c281
ms.sourcegitcommit: 0dea3b153ef823230a9d5f38351b7cef057cb299
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/12/2019
ms.locfileid: "67842344"
---
# <a name="package-restore-options"></a><span data-ttu-id="3298d-103">Možnosti obnovení balíčku</span><span class="sxs-lookup"><span data-stu-id="3298d-103">Package Restore options</span></span>

<span data-ttu-id="3298d-104">Zvýšit úroveň čištění vývojového prostředí a snížit velikost úložiště, NuGet **obnovení balíčků** instaluje všechny závislosti projektu, které jsou uvedené v souboru projektu nebo `packages.config`.</span><span class="sxs-lookup"><span data-stu-id="3298d-104">To promote a cleaner development environment and to reduce repository size, NuGet **Package Restore** installs all of a project's dependencies listed in either the project file or `packages.config`.</span></span> <span data-ttu-id="3298d-105">.NET Core 2.0 + `dotnet build` a `dotnet run` příkazy provést obnovení automatické balíčku.</span><span class="sxs-lookup"><span data-stu-id="3298d-105">The .NET Core 2.0+ `dotnet build` and `dotnet run` commands do an automatic package restore.</span></span> <span data-ttu-id="3298d-106">Visual Studio můžete balíčky obnovit automaticky při sestavení projektu, a kdykoli prostřednictvím sady Visual Studio, můžete obnovit balíčky `nuget restore`, `dotnet restore`a xbuild v Mono.</span><span class="sxs-lookup"><span data-stu-id="3298d-106">Visual Studio can restore packages automatically when it builds a project, and you can restore packages at any time through Visual Studio, `nuget restore`, `dotnet restore`, and xbuild on Mono.</span></span>

<span data-ttu-id="3298d-107">Obnovení balíčků zajišťuje, že všechny projektu závislosti jsou k dispozici, bez nutnosti mít uložené ve správě zdrojového kódu.</span><span class="sxs-lookup"><span data-stu-id="3298d-107">Package Restore makes sure that all a project's dependencies are available, without having to store them in source control.</span></span> <span data-ttu-id="3298d-108">Nakonfigurování svým úložištěm řízení zdrojů pro vyloučení binární soubory balíčku najdete v tématu [balíčky a Správa zdrojového kódu](../consume-packages/packages-and-source-control.md).</span><span class="sxs-lookup"><span data-stu-id="3298d-108">To configure your source control repository to exclude the package binaries, see [Packages and source control](../consume-packages/packages-and-source-control.md).</span></span> 

## <a name="package-restore-overview"></a><span data-ttu-id="3298d-109">Přehled obnovení balíčků</span><span class="sxs-lookup"><span data-stu-id="3298d-109">Package Restore overview</span></span>

<span data-ttu-id="3298d-110">Obnovení balíčku nejdřív nainstaluje přímé závislosti projektu podle potřeby a potom nainstaluje všechny závislosti tyto balíčky v průběhu graf závislostí pro celé.</span><span class="sxs-lookup"><span data-stu-id="3298d-110">Package Restore first installs the direct dependencies of a project as needed, then installs any dependencies of those packages throughout the entire dependency graph.</span></span>

<span data-ttu-id="3298d-111">Pokud balíček není nainstalovaná, NuGet se nejprve pokusí načíst z [mezipaměti](../consume-packages/managing-the-global-packages-and-cache-folders.md).</span><span class="sxs-lookup"><span data-stu-id="3298d-111">If a package isn't already installed, NuGet first attempts to retrieve it from the [cache](../consume-packages/managing-the-global-packages-and-cache-folders.md).</span></span> <span data-ttu-id="3298d-112">Pokud balíček není v mezipaměti, NuGet se pokusí stáhnout balíček ze všech zdrojů povoleno v seznamu v **nástroje** > **možnosti** > **Správce balíčků NuGet**   >  **Balíček zdroje** v sadě Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="3298d-112">If the package isn't in the cache, NuGet tries to download the package from all enabled sources in the list at **Tools** > **Options** > **NuGet Package Manager** > **Package Sources** in Visual Studio.</span></span> <span data-ttu-id="3298d-113">Během obnovení NuGet ignoruje pořadí zdroje balíčků a používá balíček z libovolným zdrojem je nejprve reagovat na požadavky.</span><span class="sxs-lookup"><span data-stu-id="3298d-113">During restore, NuGet ignores the order of package sources, and uses the package from whichever source is first to respond to requests.</span></span> <span data-ttu-id="3298d-114">Další informace o tom, jak se chová NuGet naleznete v tématu [konfigurace běžných NuGet](Configuring-NuGet-Behavior.md).</span><span class="sxs-lookup"><span data-stu-id="3298d-114">For more information about how NuGet behaves, see [Common NuGet configurations](Configuring-NuGet-Behavior.md).</span></span> 

> [!Note]
> <span data-ttu-id="3298d-115">NuGet neukazuje, nepovedlo se obnovit balíček, dokud byly vráceny všechny zdroje.</span><span class="sxs-lookup"><span data-stu-id="3298d-115">NuGet doesn't indicate a failure to restore a package until all the sources have been checked.</span></span> <span data-ttu-id="3298d-116">V tu chvíli NuGet hlásí selhání pouze poslední zdroje v seznamu.</span><span class="sxs-lookup"><span data-stu-id="3298d-116">At that time, NuGet reports a failure for only the last source in the list.</span></span> <span data-ttu-id="3298d-117">Chyba znamená, že nebyl k dispozici v balíčku *jakékoli* z jiných zdrojů i v případě chyby se nezobrazují pro každou z těchto zdrojů jednotlivě.</span><span class="sxs-lookup"><span data-stu-id="3298d-117">The error implies that the package wasn't present on *any* of the other sources, even though errors aren't shown for each of those sources individually.</span></span>

## <a name="restore-packages"></a><span data-ttu-id="3298d-118">Obnovení balíčků</span><span class="sxs-lookup"><span data-stu-id="3298d-118">Restore packages</span></span>

<span data-ttu-id="3298d-119">Obnovení balíčků můžete spustit v některém z následujících způsobů:</span><span class="sxs-lookup"><span data-stu-id="3298d-119">You can trigger Package Restore in any of the following ways:</span></span>

- <span data-ttu-id="3298d-120">**Visual Studio**: V sadě Visual Studio na Windows použijte jednu z následujících metod.</span><span class="sxs-lookup"><span data-stu-id="3298d-120">**Visual Studio**: In Visual Studio on Windows, use one of the following methods.</span></span>

    - <span data-ttu-id="3298d-121">Obnovení balíčků automaticky.</span><span class="sxs-lookup"><span data-stu-id="3298d-121">Restore packages automatically.</span></span> <span data-ttu-id="3298d-122">Obnovení balíčku dojde automaticky při vytvoření projektu ze šablony nebo sestavení projektu, v souladu s možností [povolení a zákaz obnovení balíčku](#enable-and-disable-package-restore-visual-studio).</span><span class="sxs-lookup"><span data-stu-id="3298d-122">Package Restore happens automatically when you create a project from a template or build a project, subject to the options in [Enable and disable package restore](#enable-and-disable-package-restore-visual-studio).</span></span> <span data-ttu-id="3298d-123">Ve Správci NuGet 4.0 + obnovit také dojde automaticky když provedete změny do sady SDK – vizuální styl projektu (obvykle projektu .NET Core nebo .NET Standard).</span><span class="sxs-lookup"><span data-stu-id="3298d-123">In NuGet 4.0+, restore also happens automatically when you make changes to a SDK-style project (typically a .NET Core or .NET Standard project).</span></span>

    - <span data-ttu-id="3298d-124">Obnovení balíčků ručně.</span><span class="sxs-lookup"><span data-stu-id="3298d-124">Restore packages manually.</span></span> <span data-ttu-id="3298d-125">Pokud chcete obnovit ručně, klikněte pravým tlačítkem na řešení v **Průzkumníka řešení** a vyberte **obnovit balíčky NuGet**.</span><span class="sxs-lookup"><span data-stu-id="3298d-125">To restore manually, right-click the solution in **Solution Explorer** and select **Restore NuGet Packages**.</span></span> <span data-ttu-id="3298d-126">Pokud jeden nebo více jednotlivých balíčků ještě nejsou nainstalovány správně, **Průzkumníka řešení** se zobrazuje ikona chyba.</span><span class="sxs-lookup"><span data-stu-id="3298d-126">If one or more individual packages still aren't installed properly, **Solution Explorer** shows an error icon.</span></span> <span data-ttu-id="3298d-127">Klikněte pravým tlačítkem a vyberte **spravovat balíčky NuGet**a použijte **Správce balíčků** odinstalovat a znovu nainstalovat ovlivněné balíčky.</span><span class="sxs-lookup"><span data-stu-id="3298d-127">Right-click and select **Manage NuGet Packages**, and use **Package Manager** to uninstall and reinstall the affected packages.</span></span> <span data-ttu-id="3298d-128">Další informace najdete v tématu [znovu nainstalovat a aktualizace balíčků](../consume-packages/reinstalling-and-updating-packages.md)</span><span class="sxs-lookup"><span data-stu-id="3298d-128">For more information, see [Reinstall and update packages](../consume-packages/reinstalling-and-updating-packages.md)</span></span>

    <span data-ttu-id="3298d-129">Pokud se zobrazí chyba "Tento projekt odkazuje na balíčky NuGet, které jsou na tomto počítači chybí" nebo "jeden nebo více balíčků NuGet je nutné obnovit, ale nepodařilo, protože nebyl udělen souhlas," [povolit automatické obnovení](#enable-and-disable-package-restore-visual-studio).</span><span class="sxs-lookup"><span data-stu-id="3298d-129">If you see the error "This project references NuGet package(s) that are missing on this computer," or "One or more NuGet packages need to be restored but couldn't be because consent has not been granted," [enable automatic restore](#enable-and-disable-package-restore-visual-studio).</span></span> <span data-ttu-id="3298d-130">Viz také [migrace na balíček automatické obnovení](#migrate-to-automatic-package-restore-visual-studio) a [obnovení balíčků řešení potíží s](Package-restore-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="3298d-130">Also, see [Migrate to automatic package restore](#migrate-to-automatic-package-restore-visual-studio) and [Package Restore troubleshooting](Package-restore-troubleshooting.md).</span></span>

- <span data-ttu-id="3298d-131">**rozhraní příkazového řádku DotNet**: Na příkazovém řádku přejděte do složky, která obsahuje váš projekt a pak použít [dotnet restore](/dotnet/core/tools/dotnet-restore?tabs=netcore2x) příkazu Obnovit balíčky uvedené v souboru projektu s [PackageReference](../consume-packages/package-references-in-project-files.md).</span><span class="sxs-lookup"><span data-stu-id="3298d-131">**dotnet CLI**: In the command line, switch to the folder that contains your project, and then use the [dotnet restore](/dotnet/core/tools/dotnet-restore?tabs=netcore2x) command to restore packages listed in the project file with [PackageReference](../consume-packages/package-references-in-project-files.md).</span></span> <span data-ttu-id="3298d-132">S .NET Core 2.0 nebo novější, obnovení se automaticky stane s `dotnet build` a `dotnet run` příkazy.</span><span class="sxs-lookup"><span data-stu-id="3298d-132">With .NET Core 2.0 and later, restore happens automatically with the `dotnet build` and `dotnet run` commands.</span></span>  

- <span data-ttu-id="3298d-133">**nuget.exe CLI**: Na příkazovém řádku přejděte do složky, která obsahuje váš projekt a pak použít [obnovení nuget](../tools/cli-ref-restore.md) příkazu Obnovit balíčky uvedené v souboru projektu nebo řešení, nebo v `packages.config`.</span><span class="sxs-lookup"><span data-stu-id="3298d-133">**nuget.exe CLI**: In the command line, switch to the folder that contains your project, and then use the [nuget restore](../tools/cli-ref-restore.md) command to restore packages listed in a project or solution file, or in `packages.config`.</span></span> 

- <span data-ttu-id="3298d-134">**MSBuild**: Použití [msbuild - t: restore](../reference/msbuild-targets.md#restore-target) příkazu Obnovit balíčky uvedené v souboru projektu pomocí PackageReference.</span><span class="sxs-lookup"><span data-stu-id="3298d-134">**MSBuild**: Use the [msbuild -t:restore](../reference/msbuild-targets.md#restore-target) command to restore packages listed in the project file with PackageReference.</span></span> <span data-ttu-id="3298d-135">Tento příkaz je k dispozici pouze v NuGet 4.x+ a MSBuild 15.1 +, které jsou součástí sady Visual Studio 2017 a vyšší verze.</span><span class="sxs-lookup"><span data-stu-id="3298d-135">This command is available only in NuGet 4.x+ and MSBuild 15.1+, which are included with Visual Studio 2017 and higher versions.</span></span> <span data-ttu-id="3298d-136">Obě `nuget restore` a `dotnet restore` použijte tento příkaz pro příslušné projekty.</span><span class="sxs-lookup"><span data-stu-id="3298d-136">Both `nuget restore` and `dotnet restore` use this command for applicable projects.</span></span>

- <span data-ttu-id="3298d-137">**Kanály Azure**: Při vytváření definice sestavení v kanálech Azure zahrnují NuGet [obnovení](/azure/devops/pipelines/tasks/package/nuget#restore-nuget-packages) nebo .NET Core [obnovení](/azure/devops/pipelines/tasks/build/dotnet-core-cli?view=azure-devops) úloh v definici předtím, než se některé úlohy sestavení.</span><span class="sxs-lookup"><span data-stu-id="3298d-137">**Azure Pipelines**: When you create a build definition in Azure Pipelines, include the NuGet [restore](/azure/devops/pipelines/tasks/package/nuget#restore-nuget-packages) or .NET Core [restore](/azure/devops/pipelines/tasks/build/dotnet-core-cli?view=azure-devops) task in the definition before any build tasks.</span></span> <span data-ttu-id="3298d-138">Některé šablony sestavení zahrnout úlohy obnovení ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="3298d-138">Some build templates include the restore task by default.</span></span>

- <span data-ttu-id="3298d-139">**Azure DevOps Server**: Azure DevOps Server a sadu TFS 2013 a novější automaticky obnovení balíčků během sestavení, pokud používáte TFS 2013 nebo vyšší šablony Team Build.</span><span class="sxs-lookup"><span data-stu-id="3298d-139">**Azure DevOps Server**: Azure DevOps Server and TFS 2013 and later automatically restore packages during build, if you're using a TFS 2013 or later Team Build template.</span></span> <span data-ttu-id="3298d-140">U starších verzí sady TFS můžete zahrnout krok sestavení spustit možnost příkazového řádku obnovení nebo volitelně šablony sestavení migrovat na novější verzi.</span><span class="sxs-lookup"><span data-stu-id="3298d-140">For earlier TFS versions, you can include a build step to run a command-line restore option, or optionally migrate the build template to a later version.</span></span> <span data-ttu-id="3298d-141">Další informace najdete v tématu [nastavit obnovení balíčku s Team Foundation Build](../consume-packages/team-foundation-build.md).</span><span class="sxs-lookup"><span data-stu-id="3298d-141">For more information, see [Set up package restore with Team Foundation Build](../consume-packages/team-foundation-build.md).</span></span>

## <a name="enable-and-disable-package-restore-visual-studio"></a><span data-ttu-id="3298d-142">Povolení a zákaz obnovení balíčku (Visual Studio)</span><span class="sxs-lookup"><span data-stu-id="3298d-142">Enable and disable package restore (Visual Studio)</span></span>

<span data-ttu-id="3298d-143">V sadě Visual Studio, můžete řídit obnovení balíčků primárně prostřednictvím **nástroje** > **možnosti** > **Správce balíčků NuGet**:</span><span class="sxs-lookup"><span data-stu-id="3298d-143">In Visual Studio, you control Package Restore primarily through **Tools** > **Options** > **NuGet Package Manager**:</span></span>

![Ovládací prvek obnovení balíčků prostřednictvím možnosti Správce balíčků NuGet](media/Restore-01-AutoRestoreOptions.png)

- <span data-ttu-id="3298d-145">**Umožnit správci balíčků NuGet stáhnout chybějící balíčky** řídí všechny formy obnovení balíčku tak, že změníte `packageRestore/enabled` nastavení [packageRestore části](../reference/nuget-config-file.md#packagerestore-section) z `NuGet.Config` souboru, v `%AppData%\NuGet\` na Windows, nebo `~/.nuget/NuGet/` na Mac/Linux.</span><span class="sxs-lookup"><span data-stu-id="3298d-145">**Allow NuGet to download missing packages** controls all forms of package restore by changing the `packageRestore/enabled` setting in the [packageRestore section](../reference/nuget-config-file.md#packagerestore-section) of the `NuGet.Config` file, at `%AppData%\NuGet\` on Windows, or `~/.nuget/NuGet/` on Mac/Linux.</span></span> <span data-ttu-id="3298d-146">Toto nastavení také povolí **obnovit balíčky NuGet** příkazu v místní nabídce řešení v sadě Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="3298d-146">This setting also enables the **Restore NuGet Packages** command on the solution's context menu in Visual Studio, .</span></span>

    ```xml
    <configuration>
        <packageRestore>
            <!-- The 'enabled' key is True when the "Allow NuGet to download missing packages" checkbox is set.
                 Clearing the box sets this to False, disabling command-line, automatic, and MSBuild-integrated restore. -->
            <add key="enabled" value="True" />
        </packageRestore>
    </configuration>
    ```
    
  > [!Note]
  > <span data-ttu-id="3298d-147">Globálně přepsat `packageRestore/enabled` nastavení, nastavte proměnnou prostředí **EnableNuGetPackageRestore** s hodnotou PRAVDA nebo NEPRAVDA před spuštěním aplikace Visual Studio nebo spuštění sestavení.</span><span class="sxs-lookup"><span data-stu-id="3298d-147">To globally override the `packageRestore/enabled` setting, set the environment variable **EnableNuGetPackageRestore** with a value of True or False before launching Visual Studio or starting a build.</span></span>

- <span data-ttu-id="3298d-148">**Automaticky zjišťovat pro chybějící balíčky během vytváření v sadě Visual Studio** řídí automatické obnovení tak, že změníte `packageRestore/automatic` nastavení [packageRestore části](../reference/nuget-config-file.md#packagerestore-section) z `NuGet.Config` souboru.</span><span class="sxs-lookup"><span data-stu-id="3298d-148">**Automatically check for missing packages during build in Visual Studio** controls automatic restore by changing the `packageRestore/automatic` setting in the [packageRestore section](../reference/nuget-config-file.md#packagerestore-section) of the `NuGet.Config` file.</span></span> <span data-ttu-id="3298d-149">Pokud tato možnost nastavená na hodnotu True, systémem sestavení ze sady Visual Studio automaticky obnoví všechny chybějící balíčky.</span><span class="sxs-lookup"><span data-stu-id="3298d-149">When this option is set to True, running a build from Visual Studio automatically restores any missing packages.</span></span> <span data-ttu-id="3298d-150">Toto nastavení nemá vliv na sestavení spusťte z příkazového řádku MSBuild.</span><span class="sxs-lookup"><span data-stu-id="3298d-150">This setting doesn't affect builds run from the MSBuild command line.</span></span>

    ```xml
    ...
    <configuration>
        <packageRestore>
            <!-- The 'automatic' key is set to True when the "Automatically check for missing packages during
                 build in Visual Studio" checkbox is set. Clearing the box sets this to False and disables
                 automatic restore. -->
            <add key="automatic" value="True" />
        </packageRestore>
    </configuration>
    ```

<span data-ttu-id="3298d-151">K povolení nebo zakázání obnovení balíčků pro všechny uživatele v počítači, vývojář nebo společnosti můžete přidat nastavení konfigurace na globální `nuget.config` souboru.</span><span class="sxs-lookup"><span data-stu-id="3298d-151">To enable or disable Package Restore for all users on a computer, a developer or company can add the configuration settings to the global `nuget.config` file.</span></span> <span data-ttu-id="3298d-152">Globální `nuget.config` je ve Windows na `%ProgramData%\NuGet\Config`, někdy v konkrétní `\{IDE}\{Version}\{SKU}\` složku Visual Studio, nebo v systému Mac/Linux na `~/.local/share`.</span><span class="sxs-lookup"><span data-stu-id="3298d-152">The global `nuget.config` is in Windows at `%ProgramData%\NuGet\Config`, sometimes under a specific `\{IDE}\{Version}\{SKU}\` Visual Studio folder, or in Mac/Linux at `~/.local/share`.</span></span> <span data-ttu-id="3298d-153">Jednotlivým uživatelům můžete selektivně povolte obnovení podle potřeby na úrovni projektu.</span><span class="sxs-lookup"><span data-stu-id="3298d-153">Individual users can then selectively enable restore as needed on a project level.</span></span> <span data-ttu-id="3298d-154">Podrobné informace o tom, jak NuGet upřednostňuje více konfiguračních souborů naleznete v tématu [konfigurace běžných NuGet](../consume-packages/configuring-nuget-behavior.md#how-settings-are-applied).</span><span class="sxs-lookup"><span data-stu-id="3298d-154">For more details on how NuGet prioritizes multiple config files, see [Common NuGet configurations](../consume-packages/configuring-nuget-behavior.md#how-settings-are-applied).</span></span>

> [!Important]
> <span data-ttu-id="3298d-155">Pokud upravíte `packageRestore` přímo v nastavení `nuget.config`, restartujte Visual Studio, tak, aby **možnosti** dialogové okno zobrazuje aktuální hodnoty.</span><span class="sxs-lookup"><span data-stu-id="3298d-155">If you edit the `packageRestore` settings directly in `nuget.config`, restart Visual Studio, so that the **Options** dialog box shows the current values.</span></span>

## <a name="constrain-package-versions-with-restore"></a><span data-ttu-id="3298d-156">Omezení verze balíčků pomocí obnovení</span><span class="sxs-lookup"><span data-stu-id="3298d-156">Constrain package versions with restore</span></span>

<span data-ttu-id="3298d-157">Když NuGet obnoví balíčky pomocí libovolné metody, respektuje žádná omezení, které jste zadali v `packages.config` nebo soubor projektu:</span><span class="sxs-lookup"><span data-stu-id="3298d-157">When NuGet restores packages through any method, it honors any constraints you specified in `packages.config` or the project file:</span></span>

- <span data-ttu-id="3298d-158">V `packages.config`, můžete zadat rozsah verzí v `allowedVersion` vlastnost závislosti.</span><span class="sxs-lookup"><span data-stu-id="3298d-158">In `packages.config`, you can specify a version range in the `allowedVersion` property of the dependency.</span></span> <span data-ttu-id="3298d-159">Zobrazit [verze k upgradu omezit](../consume-packages/reinstalling-and-updating-packages.md#constraining-upgrade-versions) Další informace.</span><span class="sxs-lookup"><span data-stu-id="3298d-159">See [Constrain upgrade versions](../consume-packages/reinstalling-and-updating-packages.md#constraining-upgrade-versions) for more information.</span></span> <span data-ttu-id="3298d-160">Příklad:</span><span class="sxs-lookup"><span data-stu-id="3298d-160">For example:</span></span>

    ```xml
    <package id="Newtonsoft.json" version="6.0.4" allowedVersions="[6,7)" />
    ```

- <span data-ttu-id="3298d-161">V souboru projektu můžete použít PackageReference přímo určovat rozsah závislostí.</span><span class="sxs-lookup"><span data-stu-id="3298d-161">In a project file, you can use PackageReference to specify a dependency's range directly.</span></span> <span data-ttu-id="3298d-162">Příklad:</span><span class="sxs-lookup"><span data-stu-id="3298d-162">For example:</span></span>

    ```xml
    <PackageReference Include="Newtonsoft.json" Version="[6, 7)" />
    ```

<span data-ttu-id="3298d-163">Ve všech případech použijte notaci podle [Správa verzí balíčků](../reference/package-versioning.md).</span><span class="sxs-lookup"><span data-stu-id="3298d-163">In all cases, use the notation described in [Package versioning](../reference/package-versioning.md).</span></span>

## <a name="force-restore-from-package-sources"></a><span data-ttu-id="3298d-164">Vynutit obnovení ze zdroje balíčku</span><span class="sxs-lookup"><span data-stu-id="3298d-164">Force restore from package sources</span></span>

<span data-ttu-id="3298d-165">Ve výchozím nastavení, operace obnovení NuGet používat balíčky z *global-packages* a *http-cache* složek, které jsou popsány v [Správa globálních balíčků a ukládat do mezipaměti složky](managing-the-global-packages-and-cache-folders.md).</span><span class="sxs-lookup"><span data-stu-id="3298d-165">By default, NuGet restore operations use packages from the *global-packages* and *http-cache* folders, which are described in [Manage the global packages and cache folders](managing-the-global-packages-and-cache-folders.md).</span></span>

<span data-ttu-id="3298d-166">Abyste se vyhnuli použití *global-packages* složky, proveďte jednu z následujících akcí:</span><span class="sxs-lookup"><span data-stu-id="3298d-166">To avoid using the *global-packages* folder, do one of the following:</span></span>

- <span data-ttu-id="3298d-167">Zrušte pomocí složky `nuget locals global-packages -clear` nebo `dotnet nuget locals global-packages --clear`.</span><span class="sxs-lookup"><span data-stu-id="3298d-167">Clear the folder using `nuget locals global-packages -clear` or `dotnet nuget locals global-packages --clear`.</span></span>
- <span data-ttu-id="3298d-168">Dočasně změnit umístění *global-packages* složky, před provedením operace obnovení, pomocí jedné z následujících metod:</span><span class="sxs-lookup"><span data-stu-id="3298d-168">Temporarily change the location of the *global-packages* folder before the restore operation, using one of the following methods:</span></span>
  - <span data-ttu-id="3298d-169">Nastavte proměnnou prostředí NUGET_PACKAGES do jiné složky.</span><span class="sxs-lookup"><span data-stu-id="3298d-169">Set the NUGET_PACKAGES environment variable to a different folder.</span></span>
  - <span data-ttu-id="3298d-170">Vytvoření `NuGet.Config` souboru, který nastaví `globalPackagesFolder` (Pokud se používá PackageReference) nebo `repositoryPath` (Pokud používáte `packages.config`) do jiné složky.</span><span class="sxs-lookup"><span data-stu-id="3298d-170">Create a `NuGet.Config` file that sets `globalPackagesFolder` (if using PackageReference) or `repositoryPath` (if using `packages.config`) to a different folder.</span></span> <span data-ttu-id="3298d-171">Další informace najdete v tématu [nastavení konfigurace](../reference/nuget-config-file.md#config-section).</span><span class="sxs-lookup"><span data-stu-id="3298d-171">For more information, see [configuration settings](../reference/nuget-config-file.md#config-section).</span></span>
  - <span data-ttu-id="3298d-172">Pouze MSBuild: Zadejte jinou složku s `RestorePackagesPath` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="3298d-172">MSBuild only: Specify a different folder with the `RestorePackagesPath` property.</span></span>

<span data-ttu-id="3298d-173">Abyste se vyhnuli použití mezipaměti u zdrojů HTTP, proveďte jednu z následujících akcí:</span><span class="sxs-lookup"><span data-stu-id="3298d-173">To avoid using the cache for HTTP sources, do one of the following:</span></span>

- <span data-ttu-id="3298d-174">Použití `-NoCache` spolu s možností `nuget restore`, nebo `--no-cache` spolu s možností `dotnet restore`.</span><span class="sxs-lookup"><span data-stu-id="3298d-174">Use the `-NoCache` option with `nuget restore`, or the `--no-cache` option with `dotnet restore`.</span></span> <span data-ttu-id="3298d-175">Tyto možnosti nechcete vliv na operace obnovení prostřednictvím správce sady Visual Studio balíček nebo konzoly.</span><span class="sxs-lookup"><span data-stu-id="3298d-175">These options don't affect restore operations through the Visual Studio Package Manager or console.</span></span>
- <span data-ttu-id="3298d-176">Vymazání mezipaměti pomocí `nuget locals http-cache -clear` nebo `dotnet nuget locals http-cache --clear`.</span><span class="sxs-lookup"><span data-stu-id="3298d-176">Clear the cache using `nuget locals http-cache -clear` or `dotnet nuget locals http-cache --clear`.</span></span>
- <span data-ttu-id="3298d-177">Dočasně nastavte proměnnou prostředí NUGET_HTTP_CACHE_PATH do jiné složky.</span><span class="sxs-lookup"><span data-stu-id="3298d-177">Temporarily set the NUGET_HTTP_CACHE_PATH environment variable to a different folder.</span></span>

## <a name="migrate-to-automatic-package-restore-visual-studio"></a><span data-ttu-id="3298d-178">Migrace na balíček automatické obnovení (Visual Studio)</span><span class="sxs-lookup"><span data-stu-id="3298d-178">Migrate to automatic package restore (Visual Studio)</span></span>

<span data-ttu-id="3298d-179">U NuGet 2.6 a dřívějších verzí obnovení balíčků integrovaný nástroj MSBuild se dříve podporovaly ale, který už není true.</span><span class="sxs-lookup"><span data-stu-id="3298d-179">For NuGet 2.6 and earlier, an MSBuild-integrated package restore was previously supported but that is no longer true.</span></span> <span data-ttu-id="3298d-180">(Jeho povolování obvykle tak, že kliknete pravým tlačítkem řešení v sadě Visual Studio a vyberete **povolit obnovení balíčků NuGet**).</span><span class="sxs-lookup"><span data-stu-id="3298d-180">(It was typically enabled by right-clicking a solution in Visual Studio and selecting **Enable NuGet Package Restore**).</span></span> <span data-ttu-id="3298d-181">Pokud váš projekt používá obnovení nepoužívané balíčku integrované nástroje MSBuild, migrujte prosím na balíček automatické obnovení.</span><span class="sxs-lookup"><span data-stu-id="3298d-181">If your project uses the deprecated MSBuild-integrated package restore, please migrate to automatic package restore.</span></span>

<span data-ttu-id="3298d-182">Projekty, které používají obnovení integrované nástroje MSBuild balíčku obvykle obsahují *.nuget* složka s tři soubory: *Soubor NuGet.config*, *nuget.exe*, a *NuGet.targets*.</span><span class="sxs-lookup"><span data-stu-id="3298d-182">Projects that use MSBuild-Integrated package restore typically contain a *.nuget* folder with three files: *NuGet.config*, *nuget.exe*, and *NuGet.targets*.</span></span> <span data-ttu-id="3298d-183">Přítomnost *NuGet.targets* soubor Určuje, zda NuGet budou i nadále použít MSBuild untegrated přístup, takže tento soubor musí být během migrace neodebere.</span><span class="sxs-lookup"><span data-stu-id="3298d-183">The presence of a *NuGet.targets* file determines whether NuGet will continue to use the MSBuild-untegrated approach, so this file must be removed during the migration.</span></span>

<span data-ttu-id="3298d-184">Migrace na balíček automatické obnovení:</span><span class="sxs-lookup"><span data-stu-id="3298d-184">To migrate to automatic package restore:</span></span>

1. <span data-ttu-id="3298d-185">Zavřete Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="3298d-185">Close Visual Studio.</span></span>
2. <span data-ttu-id="3298d-186">Odstranit *.nuget/nuget.exe* a *.nuget/NuGet.targets*.</span><span class="sxs-lookup"><span data-stu-id="3298d-186">Delete *.nuget/nuget.exe* and *.nuget/NuGet.targets*.</span></span>
3. <span data-ttu-id="3298d-187">Pro každý soubor projektu, odeberte `<RestorePackages>` elementu a odebrat všechny odkazy na *NuGet.targets*.</span><span class="sxs-lookup"><span data-stu-id="3298d-187">For each project file, remove the `<RestorePackages>` element and remove any reference to *NuGet.targets*.</span></span>

<span data-ttu-id="3298d-188">Otestovat balíček automatické obnovení:</span><span class="sxs-lookup"><span data-stu-id="3298d-188">To test the automatic package restore:</span></span>

1. <span data-ttu-id="3298d-189">Odeberte *balíčky* složku z řešení.</span><span class="sxs-lookup"><span data-stu-id="3298d-189">Remove the *packages* folder from the solution.</span></span>
2. <span data-ttu-id="3298d-190">Otevřete řešení v sadě Visual Studio a spustit sestavení.</span><span class="sxs-lookup"><span data-stu-id="3298d-190">Open the solution in Visual Studio and start a build.</span></span>

   <span data-ttu-id="3298d-191">Balíček automatické obnovení by měla stáhnout a nainstalovat každý balíček závislostí bez nutnosti přidávat do správy zdrojového kódu.</span><span class="sxs-lookup"><span data-stu-id="3298d-191">Automatic package restore should download and install each dependency package, without adding them to source control.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="3298d-192">Poradce při potížích</span><span class="sxs-lookup"><span data-stu-id="3298d-192">Troubleshooting</span></span>

<span data-ttu-id="3298d-193">Zobrazit [Poradce při potížích s obnovení balíčku](package-restore-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="3298d-193">See [Troubleshoot package restore](package-restore-troubleshooting.md).</span></span>
